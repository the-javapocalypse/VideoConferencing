<!--Device Management-->
<div [class.d-none]="!deviceManagementFLAG" class="bg-animated">
    <div class="container d-flex" style="min-height: 100vh">
        <div class="justify-content-center align-self-center m-auto">
            <div class="card py-md-2">
                <div class="card-body p-md-5">
                    <h5 class="card-title text-center">
                        Hello
                        {{storage.getRoasterInfo().attendeeName }},
                        Let's setup audio and video settings before starting the meeting.
                    </h5>
                    <div class="row p-5" [class.d-none]="deviceScreenInitFLAG">
                        <div class="text-center m-auto">
                            <nz-spin nzSimple [nzSize]="'large'"></nz-spin>
                        </div>
                    </div>
                    <div class="row pt-4" [class.d-none]="!deviceScreenInitFLAG">
                        <div class="col-12 col-md-3">
                            <!--    AUDIO INPUT CONTROLS START     -->
                            <h5>
                                Microphone
                            </h5>
                            <button class="btn btn-outline-primary dropdown-toggle btn-block" type="button"
                                    id="audioInputBtn"
                                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                {{ currentAudioInputDevice  | slice:0:20}}{{ currentAudioInputDevice.length > 20 ? '...' : '' }}
                            </button>
                            <div class="dropdown-menu" aria-labelledby="audioInputBtn">
                                <div *ngFor="let audioInput of audioInputDevices">
                                    <a class="dropdown-item"
                                       (click)="updateCurrentAudioInputDevice(audioInput.label, audioInput.deviceId)">
                                        {{audioInput.label | slice:0:20}}{{ audioInput.length > 20 ? '...' : '' }}
                                    </a>
                                </div>
                            </div>
                            <!--    AUDIO INPUT CONTROLS END     -->
                            <!--    VIDEO INPUT CONTROLS START     -->
                            <h5 class="pt-4">
                                Camera
                            </h5>
                            <div class="dropdown controls-inline">
                                <button class="btn btn-outline-primary dropdown-toggle btn-block" type="button"
                                        data-toggle="dropdown">
                                    {{currentVideoInputDevice | slice:0:20}}{{ currentVideoInputDevice.length > 20 ? '...' : '' }}
                                </button>
                                <div class="dropdown-menu" *ngFor="let videoInput of videoInputDevices">
                                    <a class="dropdown-item"
                                       (click)="updateCurrentVideoInputDevice(videoInput.label, videoInput.deviceId)">
                                        {{videoInput.label | slice:0:20}}{{ videoInput.length > 20 ? '...' : '' }}
                                    </a>
                                </div>
                            </div>
                            <!--    VIDEO INPUT CONTROLS END     -->
                            <!--    AUDIO PREVIEW START     -->
                            <h5 class="pt-4"> Microphone Test </h5>
                            <nz-progress [nzShowInfo]="false" [nzPercent]="audioInputPreview"
                                         [nzStrokeColor]="{ '0%': '#108ee9', '100%': '#87d068' }"></nz-progress>
                            <!--    AUDIO PREVIEW END     -->
                        </div>

                        <div class="col-md-1 col-0"></div>

                        <div class="col-md-3 col-12">
                            <!--    AUDIO OUTPUT CONTROLS START     -->
                            <h5 class="pt-4 pt-md-0">
                                Speaker
                            </h5>
                            <button class="btn btn-outline-primary dropdown-toggle btn-block" type="button"
                                    id="audioOutputBtn"
                                    data-toggle="dropdown">
                                {{currentAudioOutputDevice | slice:0:20}}{{ currentAudioOutputDevice.length > 20 ? '...' : '' }}
                            </button>
                            <div class="dropdown-menu" aria-labelledby="audioOutputBtn">
                                <div *ngFor="let audioOutput of audioOutputDevices">
                                    <a class="dropdown-item"
                                       (click)="updateCurrentAudioOutputDevice(audioOutput.label, audioOutput.deviceId)">
                                        {{audioOutput.label | slice:0:20}}{{ audioOutput.length > 20 ? '...' : '' }}
                                    </a>
                                </div>
                            </div>
                            <!--    AUDIO OUTPUT CONTROLS END     -->
                            <!--    VIDEO QUALITY CONTROLS START     -->
                            <h5 class="pt-4">
                                Video Quality
                            </h5>
                            <div class="dropdown controls-inline">
                                <button class="btn btn-outline-primary dropdown-toggle btn-block" type="button"
                                        data-toggle="dropdown">
                                    {{videoQualityPreview | slice:0:24}}
                                </button>
                                <div class="dropdown-menu">
                                    <a class="dropdown-item" (click)="updateVideoQualityPreview('360p')">
                                        360p
                                    </a>
                                    <a class="dropdown-item" (click)="updateVideoQualityPreview('540p')">
                                        540p
                                    </a>
                                    <a class="dropdown-item" (click)="updateVideoQualityPreview('720p')">
                                        720p
                                    </a>
                                </div>
                            </div>
                            <!--    VIDEO QUALITY CONTROLS END     -->
                            <!--    TEST SPEAKER START     -->
                            <div class="pt-4">
                                <button id='buttonTestSound' class="btn btn-outline-primary btn-block mt-3"
                                        (click)="playAudio()" [class.disabled]="speakerTestFlag">Test Speakers
                                </button>
                            </div>
                            <!--    TEST SPEAKER END     -->
                        </div>

                        <div class="col-md-1 col-0"></div>

                        <!--    VIDEO PREVIEW START     -->
                        <div class="col-md-4 col-0">
                            <h5 class="pt-3 pt-md-4"> Video Preview </h5>
                            <video id="video-preview" class="previewVideo px-2 pt-3 pt-md-2"></video>
                            <!--    VIDEO PREVIEW END     -->
                        </div>
                    </div>
                    <div class="row" [class.d-none]="!deviceScreenInitFLAG">
                        <div class="col-md-8 col-12 pt-5 pt-md-3">
                            <button class="btn btn-block btn-primary" (click)="joinMeeting()">
                                Join
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--Device Management END-->

<!--Meeting Screen Start-->
<div [class.d-none]="deviceManagementFLAG" class="container-fluid m-0 p-0 h-100vh">
    <div class="row no-gutters">
        <!--Meeting Controllers START-->
        <div class="col-md-3 h-100vh controllerMeetingDiv">
            <div class="container">
                <!--  Meeting Name    -->
                <h3 class="text-center py-2 pt-3">
                    {{meetingName}}
                </h3>
                <!--  Meeting Device Controllers    -->
                <div class="d-inline-block w-100">
                    <h4 class="p-md-1 text-center">
                        <!--  Mute Handler  -->
                        <span class="px-3">
                          <i nz-icon nzType="audio"
                             nzTheme="{{ audioInputUnmute ? 'twotone' : 'outline' }}"
                             (click)="muteHandler()"
                             nz-tooltip nzTooltipTitle="{{ audioInputUnmute ? 'Mic on' : 'Mic off' }}"></i>
                        </span>
                        <!--  Video Handler  -->
                        <span class="px-3">
                          <i nz-icon nzType="video-camera"
                             nzTheme="{{ videoInput ? 'twotone' : 'outline' }}"
                             (click)="videoInputHandler()"
                             nz-tooltip nzTooltipTitle="{{ videoInput ? 'Video on' : 'Video off' }}"></i>
                        </span>
                        <!--  Screen Share Handler  -->
                        <span class="px-3">
                          <i nz-icon nzType="credit-card"
                             nzTheme="{{ shareScreen ? 'twotone' : 'outline' }}"
                             (click)="shareScreenInputHandler()"
                             nz-tooltip
                             nzTooltipTitle="{{ shareScreen ? 'Screen is sharing' : 'Screen is not sharing' }}"></i>
                        </span>
                        <!--  Leave Meeting Handler  -->
                        <span class="px-3">
                          <i nz-icon nzType="phone" [nzTwotoneColor]="'#eb2f96'"
                             nzTheme="twotone"
                             nz-tooltip nzTooltipTitle="Leave Meeting"
                             nz-popconfirm
                             nzPopconfirmTitle="Are you sure you want to leave meeting?"
                             nzPopconfirmPlacement="bottom"
                             nzOkText="Leave"
                             (nzOnConfirm)="leaveMeeting()"></i>
                        </span>
                    </h4>
                </div>
                <!--  Attendees Div START  -->
                <div>
                    <nz-divider nzText="Attendees" nzOrientation="left"></nz-divider>
                    <!--  Show spinner while joining meeting  -->
                    <nz-spin nzSimple [nzSize]="'large'" class="text-center pt-5"
                             [class.d-none]="rosterData.length > 0"></nz-spin>
                    <!--  Attendees List START  -->
                    <ul class="list-group list-group-flush" id="AttendeeList">
                        <li class="list-group-item px-md-2 m-0" *ngFor="let data of rosterData">
                            <div class="row no-gutters" *ngIf="roster[data].name !== null">
                                <!--  Attendees Avatar col  -->
                                <div class="col-md-2 col-2">
                                    <img alt="Raised circle image"
                                         class="img-fluid rounded-circle shadow-lg attendeeAvatar"
                                         src='https://ui-avatars.com/api/?name={{roster[data].name}}&rounded=true&background=000&color=fff'>
                                </div>
                                <!--  Attendees Name col  -->
                                <div class="col-md-7 col-7">
                                    <p class="pt-2 pl-1 text-wrap d-inline-block">
                                        {{roster[data].name}}
                                    </p>
                                </div>
                                <!--  Attendees Indicators col  -->
                                <div class="col-md-3 col-3">
                                    <h5>
                                        <!--  Todo: Screen Sharing Indicator  -->
                                        <!--                    <i nz-icon nzType="credit-card" nzTheme="twotone"></i>-->
                                        <!--  Speaking Indicator  -->
                                        <i nz-icon nzType="audio" nzTheme="twotone"
                                           [class.d-none]="!roster[data].active || roster[data].muted"
                                           nz-tooltip nzTooltipTitle="{{roster[data].name}} is speaking"></i>&nbsp;
                                        <!--  Mute Indicator  -->
                                        <i nz-icon nzType="audio" nzTheme="twotone" [nzTwotoneColor]="'#eb2f96'"
                                           [class.d-none]="!roster[data].muted"
                                           nz-tooltip nzTooltipTitle="{{roster[data].name}}'s mic is muted"></i>&nbsp;
                                        <!--  Wifi signals Indicator  -->
                                        <i nz-icon nzType="wifi" nzTheme="outline"
                                           class="{{ roster[data].signalStrength == 0 ? 'text-danger' : roster[data].signalStrength >= 1 ? 'text-success' : 'text-warning'}}"
                                           nz-tooltip
                                           nzTooltipTitle="{{ roster[data].signalStrength == 0 ? 'Poor connection' : roster[data].signalStrength >= 1 ? 'Strong connection' : 'Weak connection'}}"></i>
                                    </h5>
                                </div>
                            </div>
                        </li>
                    </ul>
                    <!--  Attendees List END  -->
                </div>
                <!--  Attendees Div END  -->
            </div>
        </div>
        <div class="col-md-9" style="background-color: #040C23">

<!--            <div class="h-100vh d-flex" *ngIf="noVideoInputFlag">-->
<!--                <h2 class="m-auto text-light">-->
<!--                    Nobody is sharing video-->
<!--                </h2>-->
<!--            </div>-->

            <div class="row no-gutters">
                <div class="col-md-12 videoStream" id="tile-1">
                    <video id="video-1" class="meetingVideo"></video>
                </div>
            </div>

            <div class="row no-gutters">
                <div class="col-md-12 videoStream" id="tile-2">
                    <video id="video-2" class="meetingVideo"></video>
                </div>
            </div>

        </div>
        <!--Meeting Controllers END-->
    </div>
    <audio id="meeting-audio" style="display:none"></audio>

</div>
